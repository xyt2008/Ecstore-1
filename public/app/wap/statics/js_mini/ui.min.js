var AutoPlay=new Class({options:{autoplay:!0,interval:3E3,pauseOnHover:!0},_autoInit:function(a){this.options.autoplay&&(this.autofn=a||function(){},this.autoEvent().startAutoplay())},autoEvent:function(){this.options.pauseOnHover&&this.container&&this.container.addEvents({mouseenter:this.stopAutoplay.bind(this),mouseleave:function(){this.startAutoplay()}.bind(this)});return this},startAutoplay:function(){this.paused=!1;this.autoTimer=function(){this.paused||this.autofn()}.periodical(this.options.interval,
this)},stopAutoplay:function(){this.autoTimer&&(clearInterval(this.autoTimer),this.autoTimer=void 0);this.paused=!0}}),LazyLoad=new Class({Implements:[Options,Events],options:{img:"data-src",textarea:"action-lazyload",lazyDataType:"textarea",execScript:!0,islazyload:!0,lazyEventType:"beforeSwitch",onAfter:function(){}},loadCustomLazyData:function(a,b){var c,d,e=this.options.textarea,f=this.options.img;this.options.islazyload&&Array.from(a).each(function(a){switch(b){case "img":d="IMG"===a.nodeName?
[a]:a.getElements("img");d.each(function(a){this.loadImgSrc(a,f)},this);break;default:(c=a.getElement("textarea"))&&c.hasClass(e)&&this.loadAreaData(c)}},this)},loadImgSrc:function(a,b,c){b=b||this.options.img;var d=a.getProperty(b);a.removeProperty(b);d&&a.src!=d&&imageReady(d,function(){a.src=d;c&&c()},function(){this.fireEvent("after",a)}.bind(this))},loadAreaData:function(a,b){var c=(new Element("div")).inject(a,"before");this.stripScripts(a.value,c);a.destroy();b&&b()},isAllDone:function(){var a=
this.options.lazyDataType,b=this.options[a],c,d,e="img"===a;if(a&&this.container)for(a=this.container.getElements(a),c=0,d=a.length;c<d;c++)if(e?a[c].get(b):a[c].hasClass(b))return!1;return!0},stripScripts:function(a,b){var c="",d=a.replace(/<script[^>]*>([\s\S]*?)<\/script>/gi,function(a,b){c+=b+"\n";return""});b.set("html",this.options.execScript?d:a);this.options.execScript&&Browser.exec(c)},_lazyloadInit:function(a){this.addEvent(this.options.lazyEventType,function(){var b="function"==typeOf(a)?
a(arguments):a;this.loadCustomLazyData(b,this.options.lazyDataType);this.isAllDone()&&this.removeEvent(this.options.lazyEventType,arguments.callee)}.bind(this))}}),DataLazyLoad=new Class({Extends:LazyLoad,options:{containers:document,threshold:null,syncEl:null,config:{mod:"manual",diff:"default",placeholder:""}},initialize:function(a,b){this.setOptions(a);b=b||this.options.containers;this.containers=Array.from(b);this.containers.length&&(window.Shop&&(this.options.config.placeholder=Shop.url.placeholder),
this.lazyinit())},lazyinit:function(){this.threshold=this.getThreshold();this.filterItems().getItemsLength();this.initLoadEvent()},filterItems:function(){var a=[],b=[];this.containers.each(function(c){a=a.combine(c.getElements("img").filter(this.filterImg,this));b=b.combine(c.getElements("textarea").filter(this.filterArea,this))},this);this.images=a;this.areas=b;return this},filterImg:function(a){var b=this.options.img,c=a.getAttribute(b),d=this.threshold,e=this.options.config.placeholder;if("manual"===
this.options.config.mod){if(c)return e&&(a.src=e),!0}else if($(a).getOffsets().y>d&&!c)return a.set(b,a.src),e?a.src=e:a.removeAttribute("src"),!0},filterArea:function(a){return a.hasClass(this.options.textarea)},initLoadEvent:function(){function a(){d.threshold=d.getThreshold();b()}function b(){c||(c=function(){d.loadItems.call(d);d.getItemsLength()||e.removeEvents({scroll:b,resize:a});c=null}.delay(100))}var c,d=this,e=window;e.addEvent("domready",this.loadItems.bind(this));this.getItemsLength()&&
e.addEvents({scroll:b,resize:a})},loadItems:function(){var a=this.options.syncEl;if(a)return this.loadsync(this[a],a);this.initItems(this.images.concat(this.areas));this.fireEvent("callback")},initItems:function(a){var b=window.getScroll().y,c=this.threshold+b,d={images:[],areas:[]},e={areas:"loadAreaData",images:"loadImgSrc"};a.each(function(a){var b="TEXTAREA"==a.tagName?"areas":"images";a=$(a);b&&"none"==a.getStyle("display")&&a.getParent();if(a.getOffsets().y<=c)this[e[b]](a);else d[b].push(a)},
this);this.images=d.images;this.areas=d.areas},loadsync:function(a,b){if(a.length){var c=window.getScroll().y,d=this.threshold+c,e="areas"==b;a=a.filter(function(a){e&&(a="none"==a.getStyle("display")?a.parentNode:a);return a.getOffsets().y<=d});if(a.length){var c=a.shift(),f=this.loadsync.bind(this,[this[b].erase(c),b]);if(e)return this.loadAreaData(c,f);this.loadImgSrc(c,!1,f)}}},getThreshold:function(){if(this.options.threshold)return this.options.threshold;var a=this.options.config.diff,b=window.getSize().y;
return"default"===a?1*b:b+a},getItemsLength:function(){return this.images.length+this.areas.length}}),Tabs=new Class({Implements:[AutoPlay,LazyLoad],options:{eventType:"mouse",hasTriggers:!0,triggersBox:".switchable-triggerBox",triggers:".switchable-trigger",content:".switchable-content",panels:".switchable-panel",activeIndex:0,activeClass:"active",steps:1,delay:100,haslrbtn:!1,prev:".prev",next:".next",autoplay:!1,disableCls:null},initialize:function(a,b){if(this.container=$(a))this.setOptions(b),
this.activeIndex=this.options.activeIndex,this.init()},init:function(){this.fireEvent("load");this.getMarkup();this.triggersEvent().extendPlugins();this.options.hasTriggers&&this.triggers[this.activeIndex]&&this.triggers[this.activeIndex].addClass(this.options.activeClass);this.options.showClass&&this.panels[this.activeIndex]&&this.panels[this.activeIndex].addClass(this.options.showClass);this.options.islazyload&&this.fireEvent("beforeSwitch",{toIndex:this.activeIndex});this.fireEvent("init")},extendPlugins:function(){var a=
this.options;a.autoplay&&this._autoInit(this.autofn.bind(this));a.islazyload&&this._lazyloadInit(this.getLazyPanel.bind(this));Tabs.plugins.each(function(a){a.init&&a.init.call(this)},this)},autofn:function(){this.switchTo(this.activeIndex<this.length-1?this.activeIndex+1:0,"FORWARD")},getMarkup:function(){var a=this.container,b=this.options,c;b.hasTriggers&&(c=$(b.triggersBox)||a.getElement(b.triggersBox));this.triggers=c?c.getChildren():a.getElements(b.triggers);panels=this.panels=a.getElements(b.panels);
this.content=$(b.content)||a.getElement(b.content)?a.getElement(b.content):panels[0]?panels[0].getParent():[];this.content=Array.from(this.content);!panels.length&&this.content.length&&(this.panels=this.content[0].getChildren());if(!this.panels.length)return this;this.activeIndex=this.activeIndex.limit(0,this.panels.length-1);this.length=this.panels.length/b.steps},triggersEvent:function(){var a=this.options,b=this.triggers;a.hasTriggers&&b.each(function(b,d){b.addEvent("click",function(a){this.options.stopEvent&&
a.stop();this.triggerIsValid(d)&&this.cancelTimer().switchTo(d)}.bind(this));"mouse"===a.eventType&&b.addEvents({mouseenter:function(b){this.triggerIsValid(d)&&(this.switchTimer=this.switchTo.delay(a.delay,this,d))}.bind(this),mouseleave:this.cancelTimer.bind(this)})},this);a.haslrbtn&&this.lrbtn();return this},lrbtn:function(){var a=this;["prev","next"].each(function(b){this[b+"btn"]=this.container.getElements(this.options[b]).addEvent("click",function(c){if(!this.hasClass(a.options.disableCls))a[b]()})},
this);this.disabledBtn()},disabledBtn:function(){var a=this.options.disableCls;a&&this.addEvent("switch",function(b){b=b.currentIndex;b=0===b?this.prevbtn:b===Math.ceil(this.length)-1?this.nextbtn:void 0;this.nextbtn.removeClass(a);this.prevbtn.removeClass(a);b&&b.addClass(a)}.bind(this))},triggerIsValid:function(a){return this.activeIndex!==a},cancelTimer:function(){this.switchTimer&&(clearTimeout(this.switchTimer),this.switchTimer=void 0);return this},switchTo:function(a,b){var c=this.options,d=
this.triggers,e=this.panels,f=this.activeIndex,h=c.steps,l=f*h,g=a*h;if(!this.triggerIsValid(a))return this;this.fireEvent("beforeSwitch",{toIndex:a});c.hasTriggers&&this.switchTrigger(-1<f?d[f]:null,d[a]);void 0===b&&(b=a>f?"FORWARD":"BACKWARD");this.switchView(e.slice(l,l+h),e.slice(g,g+h),a,b);this.activeIndex=a;return this.fireEvent("switch",{currentIndex:a})},switchTrigger:function(a,b,c){c=this.options.activeClass;a&&a.removeClass(c);b&&b.addClass(c)},switchView:function(a,b,c,d){if(c=this.options.showClass)a[0].removeClass(c),
b[0].addClass(c);a[0].setStyle("display","none");b[0].setStyle("display","")},prev:function(){var a=this.activeIndex;this.switchTo(0<a?a-1:this.length-1,"BACKWARD")},next:function(){var a=this.activeIndex;this.switchTo(a<this.length-1?a+1:0,"FORWARD")},getLazyPanel:function(a){var b=this.options.steps;a=a[0].toIndex*b;return this.panels.slice(a,a+b)}});Tabs.plugins=[];
Tabs.Effects={none:function(a,b){a[0].setStyle("display","none");b[0].setStyle("display","block")},fade:function(a,b){if(1!==a.length)throw Error("fade effect only supports steps == 1.");var c=a[0],d=b[0];this.anim&&this.anim.cancel();this.anim=(new Fx.Tween(c,{duration:this.options.duration,onStart:function(){d.setStyle("opacity",1)},onCancel:function(){this.element.setOpacity(0);this.fireEvent("complete")},onComplete:function(){d.setStyle("zIndex",2);c.setStyle("zIndex",1);this.anim=void 0}.bind(this)})).start("opacity",
1,0)},scroll:function(a,b,c,d){function e(a){for(var b=n?l-1:0,c=(b+1)*m,b=b*m;b<c;b++){var d=(n?-1:1)*p*l;q[b].setStyle("position",a?"relative":"").setStyle(k,a?d:"")}return a?n?p:-p*l:g.setStyle(k,n?-p*(l-1):"")}var f=this;b=this.options;a=this.activeIndex;var h="scrollx"===b.effect,l=this.length,g=this.content[0],p=this.viewSize[h?0:1],m=b.steps,q=this.panels,k=h?"left":"top";b=-p*c;var r,n="FORWARD"!==d,k="absolute"==g.getStyle("position")?k:"margin-"+k;(r=n&&0===a&&c===l-1||!n&&a===l-1&&0===
c)&&(b=e.call(this,!0));fromp=g.getStyle(k).toInt();fromp=isNaN(fromp)?0:fromp;this.anim&&this.anim.cancel();this.anim=(new Fx.Tween(g,{duration:this.options.duration,transition:this.options.transition,onComplete:function(){r&&e.call(f);this.anim=void 0}.bind(this)})).start(k,fromp,b)}};Effects=Tabs.Effects;Effects.scrollx=Effects.scrolly=Effects.scroll;
var Switchable=new Class({Extends:Tabs,options:{autoplay:!0,position:"absolute",isFloat:!0,effect:"none",circular:!1,duration:500,transition:Fx.Transitions.linear,direction:"FORWARD",viewSize:[]},extendPlugins:function(){this.parent();this.effInit()},effInit:function(){var a=this.options,b=a.effect,c=this.panels,d=this.content[0],e=a.steps,f=this.activeIndex,h=c.length,l=c[0].measure(function(){return{x:this.getSize().x?this.getSize().x+this.getPatch("margin").x:this.getStyle("width").toInt()+this.getPatch().x,
y:this.getSize().y?this.getSize().y+this.getPatch("margin").y:this.getStyle("height").toInt()+this.getPatch().y}});this.viewSize=[a.viewSize[0]||l.x*e,a.viewSize[1]||l.y*e];if("none"!==b)switch(b){case "scrollx":case "scrolly":"absolute"==a.position?(d.setStyle("position","absolute"),d.getParent().setStyles({position:"relative"})):"relative"==a.position&&d.setStyle("position","relative");"scrollx"===b&&(a.isFloat&&c.setStyle("float","left"),d.setStyle("width",h/e*this.viewSize[0]));break;case "fade":var g=
f*e,p=g+e-1,m;c.each(function(b,c){m=c>=g&&c<=p;b.setStyles({opacity:m?1:0,position:a.position||"",zIndex:m?2:1})})}},switchView:function(a,b,c,d){var e=this.options,f=e.effect,h=e.circular,f="function"==typeOf(f)?f:Effects[f];h&&(d=e.direction);f&&f.call(this,a,b,c,d)}}),Accordion=new Class({Extends:Tabs,options:{eventType:"click",multiple:!1},triggerIsValid:function(a){return this.activeIndex!==a||this.options.multiple},switchView:function(a,b,c){var d=this.options;b=b[0];d.multiple?(this.triggers[c].toggleClass(d.activeClass),
b.setStyle("display","none"==b.getStyle("display")?"block":"none")):(a[0].setStyle("display","none"),b.setStyle("display","block"))}}),Slide=new Class({Extends:Switchable,options:{viewStep:4},effect:function(a,b,c,d){function e(a){for(var b=k?h-1:0,c=(b+1)*p,b=b*p;b<c;b++){var d=(k?-1:1)*g*h;m[b].setStyle("position",a?"relative":"").setStyle(q,a?d:"")}return a?k?g:-g*h:l.setStyle(q,k?-g*(h-1):"")}a=this.options;b=this.activeIndex;var f="scrollx"===a.effect,h=this.length,l=this.content[0],g=this.viewSize[f?
0:1],p=a.steps,m=this.panels,q=f?"left":"top",f=-g*c,k="FORWARD"!==d;if(k&&0===b&&c===h-1||!k&&b===h-1&&0===c)f=e.call(this,!0);fromp=l.getStyle(q).toInt();fromp=isNaN(fromp)?0:fromp;if(this.anim)return this;var r=[],n=a.viewStep,s=n-p;this.anim=(new Fx.Tween(l,{duration:this.options.duration,transition:this.options.transition,onStart:function(){this.to[0].value=k?g:-g;if(!k){for(var a=c,b,d=n-1;0<=d;d--)a++,a>h&&(b||(b=n-d),r.push(d),m[d].setStyle(q,b*g));c||(m[s].setStyle(q,g),m[0].setStyle(q,g))}},
onComplete:function(){l.setStyle(q,0);m.each(function(a,b){var d=c?-g*c:0,e=c+n-h;k&&b<e&&(d=-g*(c-h));!k&&r.contains(b)&&(d=g*(s-r[0]));a.setStyle("position","relative").setStyle(q,d)});this.anim=void 0}.bind(this)})).start(q,fromp,f)},switchView:function(a,b,c,d){var e=this.options;e.circular&&(d=e.direction);this.effect(a,b,c,d)}});
Switchable.autoRender=function(a,b){var c=a||".auto-bind-widget",c=$(b||document.body).getElements(c),d;Array.from($$("img[data-src]"),$$("textarea.action-lazyload")).length&&(d=$(document.body).get("data-lazyload-config")||"",new DataLazyLoad(JSON.decode(d)));c.length&&c.each(function(a){var b=a.get("data-widget-type");if(b&&-1<"Tabs Switchable Slide DropMenu Accordion DataLazyLoad".indexOf(b))try{d=a.get("data-widget-config")||"";if("DataLazyLoad"===b)return new window[b](JSON.decode(d),a);new window[b](a,
JSON.decode(d))}catch(c){}})};window.addEvent("domready",Switchable.autoRender.bind(Switchable));